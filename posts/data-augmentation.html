<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Intro to Data Augmentation</title>
  <meta name="author" content="Elijah Tarr" />
  <meta name="description" content="oriont's posts" />
  <meta name="keywords" content="coding,programming" />

  <link rel="stylesheet" href="/assets/css/style.css" />
  <script>
    if (
      localStorage.getItem("color-theme") === "dark" ||
      (!("color-theme" in localStorage) &&
        window.matchMedia("(prefers-color-scheme: dark)").matches)
    ) {
      document.documentElement.classList.add("dark");
    } else {
      document.documentElement.classList.remove("dark");
    }
  </script>

  

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=G-YW05BX01LE"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-YW05BX01LE");
  </script>
</head>


  <body class="dark:bg-zinc-800">
    <div class="container w-full md:max-w-3xl mx-auto pt-2 md:pt-10">
      <div
        class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal"
        style="font-family: Georgia, serif"
      >
        
        <div class="flex pt-2">
          <p class="my-auto p-0"><a href="/" class="link pr-5">Home</a></p>
          <button
  id="theme-toggle"
  type="button"
  class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5"
>
  <svg
    id="theme-toggle-light-icon"
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
    stroke-width="1.5"
    stroke="currentColor"
    class="w-6 h-6 hidden"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"
    />
  </svg>

  <svg
    id="theme-toggle-dark-icon"
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
    stroke-width="1.5"
    stroke="currentColor"
    class="w-6 h-6 hidden"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"
    />
  </svg>
</button>

<script>
  var themeToggleDarkIcon = document.getElementById("theme-toggle-dark-icon");
  var themeToggleLightIcon = document.getElementById("theme-toggle-light-icon");

  // Change the icons inside the button based on previous settings
  if (
    localStorage.getItem("color-theme") === "dark" ||
    (!("color-theme" in localStorage) &&
      window.matchMedia("(prefers-color-scheme: dark)").matches)
  ) {
    themeToggleLightIcon.classList.remove("hidden");
  } else {
    themeToggleDarkIcon.classList.remove("hidden");
  }

  var themeToggleBtn = document.getElementById("theme-toggle");

  themeToggleBtn.addEventListener("click", function () {
    // toggle icons inside button
    themeToggleDarkIcon.classList.toggle("hidden");
    themeToggleLightIcon.classList.toggle("hidden");

    // if set via local storage previously
    if (localStorage.getItem("color-theme")) {
      if (localStorage.getItem("color-theme") === "light") {
        document.documentElement.classList.add("dark");
        localStorage.setItem("color-theme", "dark");
      } else {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("color-theme", "light");
      }

      // if NOT set via local storage previously
    } else {
      if (document.documentElement.classList.contains("dark")) {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("color-theme", "light");
      } else {
        document.documentElement.classList.add("dark");
        localStorage.setItem("color-theme", "dark");
      }
    }
  });
</script>

        </div>
         
        <h1 class="pt-3 md:pt-6 text-3xl md:text-4xl">Intro to Data Augmentation</h1>
         
        <p class="md:text-base font-normal text-gray-600 dark:text-gray-400">
          2021-11-30
        </p>
        

        <div id="markdown"><p>Datasets are the heart of any machine learning model.
We use them to fine tune the model’s parameters in order to make better predictions.</p>

<p>A big factor in the accuracy of the predictions is the quality of data provided.
We may use different models and training algorithms to improve the accuracy of our model, but none of that matters if we have bad data.
For example, imagine we want to train a model to recognize if a picture contains text.
Our dataset could consist of thousands of images of many different books as the text images, and paintings, clothing, and houses as the non-text images.
When we train the model, it should be able to tell apart books from houses. Great!</p>

<p>However, what if we show the model a car with a bumper sticker?
The model was trained on only different books, so it probably won’t recognize the text unless it is encapsulated in a nice white rectangle. (page of a book)
It could go the other way as well: the model would likely predict that an image contains text, if that image is a page of a book with scribbles on it instead of text.</p>

<p>Now, consider we had a much more diverse dataset, full of books, signs, papers, bumper stickers, receipts, and text messages classified as text, and paintings, houses, cars, mountains, forests, and animals classified as no-text.
A model trained off of this new dataset would probably be able to detect if an image has text with much more accuracy than the last model.
Since there is more variety in our training data, the model won’t overfit to a certain type of data and will be more likely to classify abstract cases correctly.
So, it would probably predict that a computer screen with this post has text, and it would also likely predict that a scene from a video game doesn’t.</p>

<h1 id="small-datasets">Small Datasets</h1>

<p>Collecting data can be super annoying.
Sometimes, entering all the (potentially thousands of) features takes egregious amounts of time. (Handwritten surveys, for example.)
Other times, data points are hard to come by. (Light bent by a black hole, for example.)</p>

<p>When I refer to small datasets, I’ll be talking about datasets with less than 1000 entries.
Realistically however, small datasets by today’s standards can contain tens or hundreds of thousands of entries.</p>

<p>It’s possible to train models on small datasets.
With smart model engineering, careful hyperparameter tuning, and correctly-sized validation/testing sets, very good models can be trained on minimal data.</p>

<p>However, it’s generally safer (and much easier) to train models on large datasets.
This is because the model parameters can be adjusted more according to the dataset, but since there are more values, it won’t be overfitted to a few values.</p>

<h1 id="expanding-your-datasets">Expanding Your Datasets</h1>

<p>What do you do if you have a limited amount of data, but want a larger dataset for training your model?
<a href="https://en.wikipedia.org/wiki/Data_augmentation">Data augmentation</a> can be a great solution.</p>

<p>Data augmentation is the act of expanding an existing dataset by creating altered copies of the original data.
Altered copies can be created in infinite ways: simple transformations are most commonly used.
For any dataset, we can add small amounts of noise to each value in the dataset.
This should keep the data representative of what it was before, since the noise is small.
However, adding noise that is too large can harm the data, which makes it useless.
Access caution!</p>

<p>For images specifically, we can get a little creative with data augmentation.
Actions such as cropping the image, rotating the image, and flipping the image are easy to implement and effective ways to augment your data.
Less common ways include blurring, color swapping, inverting, and dialating the image.</p>

<p>If the image is made smaller but kept as the same size in pixels, it will have a blank background.
This can be harmful to models, since the drastic change in variety of color and non-zero values will be very easy for the model to pick up on, which can lead to the model training incorrectly.
So, the image can be flipped and repeated on each edge as a slight remedy.
Notice, however, that this can still cause strange outputs in your model.</p>

<h1 id="overfitting">Overfitting</h1>

<p>Not all datasets are small.
In the case of a large dataset and a very complex model, data augmentation can still help!</p>

<p>By adding slightly altered versions of the image, we are essentially performing a <a href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">regularization technique</a>.
Regularization is the act of reducing overfitting; in this case, the added data will increase the chances of the model picking up more general patterns, instead of learning the exact patterns from our dataset, which will result in a better performing model.</p>

<p>The problem of overfitting (relevant to data augmentation) will only arise when your model is sufficiently complex (a very deep neural network, perhaps?) compared to the dataset, despite it being medium to large in size.
So, it’s best to use your own judgement to use it or not in such cases.
Or, maybe you could train a model with data augmentation and another without it, and choose whichever one performs better as the final model.</p>

<h1 id="tensorflow">TensorFlow</h1>

<p>Luckily, data augmentation tools are provided with tensorflow, which is a commonly used library in machine learning for models and data modification.
They have a great guide on their documentation, <a href="https://www.tensorflow.org/tutorials/images/data_augmentation">which can be found here.</a></p>

<p>Data augmentation can be performed in pretty much any library.
Another common python library is numpy, <a href="https://medium.com/@schatty/image-augmentation-in-numpy-the-spell-is-simple-but-quite-unbreakable-e1af57bb50fd">which also can be used for data augmentation.</a></p>

</div>

        <footer class="text-slate-400 pt-10 pb-7">
          <a class="link" href="/">Home</a> -
          <a class="link" href="/about">About</a> -
          <a class="link" href="/resume">Resume</a> -
          <a class="link" href="/games">Games</a>
          <br />
          Copyright © 2023 - Elijah Tarr
        </footer>
      </div>
    </div>
  </body>
</html>
